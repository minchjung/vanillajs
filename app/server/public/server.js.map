{"version":3,"file":"server.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,MAAIA,IAAsB;ACA1BA,OAAwB,WAACC,CAAD,EAAUC,CAAV,EAAUA;AACjC,WAAI,IAAIC,CAAR,IAAeD,CAAf;AACIF,UAAoBI,CAApBJ,CAAsBE,CAAtBF,EAAkCG,CAAlCH,KAAkCG,CAASH,EAAoBI,CAApBJ,CAAsBC,CAAtBD,EAA+BG,CAA/BH,CAA3CA,IACFK,OAAOC,cAAPD,CAAsBJ,CAAtBI,EAA+BF,CAA/BE,EAAoC;AAAEE,uBAAY,CAAd;AAAoBC,eAAKN,EAAWC,CAAXD;AAAzB,SAApCG,CADEL;AADJ;AAE0EG,KDHjD;AED1BH,OAAwB,WAACS,CAAD,EAAMC,CAAN;AAAA,aAAgBL,OAAOM,SAAPN,CAAiBO,cAAjBP,CAAgCQ,IAAhCR,CAAqCI,CAArCJ,EAA0CK,CAA1CL,CAAhB;AAAA,KFCE;AGA1BL,OAAyBC;AACH,4BAAXa,MAAW,IAAeA,OAAOC,WAAtB,IACpBV,OAAOC,cAAPD,CAAsBJ,CAAtBI,EAA+BS,OAAOC,WAAtCV,EAAmD;AAAEW,eAAO;AAAT,OAAnDX,CADoB,EAGrBA,OAAOC,cAAPD,CAAsBJ,CAAtBI,EAA+B,YAA/BA,EAA6C;AAAEW,gBAAO;AAAT,OAA7CX,CAHqB;AAGiC;AHJ7B,GAA1B;AAAA;;;;;;;AI6CA,MC+CAY;AAzFEC,qBAAoBC;AAAAA,UAANC,CAAMD,QAARC,IAAQD;AAAAA,mBAAFA,KAAEA;;AAAAA;;AAAAA;;AAAAA;;AAAAA;;AAAAA;;AAAAA;;AAAAA;;AAAAA;;AAAAA;;AAAAA;;AAAAA;;AAClBE,WAAKC,UAALD,GAAgB,EAAhBA,EACAA,KAAKE,KAALF,GAAY,EADZA,EAEAA,KAAKD,IAALC,GAAYD,CAFZC,EAGAA,KAAKF,KAALE,GAAaF,CAHbE,EAIAA,KAAKG,MAALH,GAAc,CAJdA,EAKAA,KAAKI,MAALJ,GAAc,CALdA,EAOAA,KAAKK,WAALL,GAAmBA,KAAKM,YAALN,CAAkBO,IAAlBP,CAAuBA,IAAvBA,CAPnBA,EAQAA,KAAKQ,YAALR,GAAoBA,KAAKS,kBAALT,CAAwBO,IAAxBP,CAA6BA,IAA7BA,CARpBA;AAWFU;;AA6EF;AAAA;AAAA,aA7EEA,kBAASZ,CAATY,EAASZ;AACPE,aAAKF,KAALE,GAAaF,CAAbE,EAEGA,KAAKC,UAALD,CAAgBW,MAAhBX,GAAyB,CAAzBA,IACDA,KAAKC,UAALD,CAAgBA,KAAKG,MAArBH,EAA6BU,QAA7BV,CAAsCF,CAAtCE,CAHFA,EAKGA,KAAKE,KAALF,CAAWW,MAAXX,GAAoB,CAApBA,IACDA,KAAKE,KAALF,CAAWY,GAAXZ,CAAea;AAAAA,iBAAQA,EAAKH,QAALG,CAAcf,CAAde,CAARA;AAAAA,SAAfb,CANFA;AASFc;AAmEF;AAAA;AAAA,aAnEEA,iBAAQC,CAARD,EAAQC;AACFf,aAAKe,IAALf,KAAYA,KAAKe,IAALf,GAAYe,CAAxBf,GACJA,KAAKgB,EAALhB,GAAWA,KAAKe,IAALf,CAAUiB,aAAVjB,YAA4BA,KAAKD,IAAjCC,EADPA,EAIDA,KAAKC,UAALD,CAAgBW,MAAhBX,GAAyB,CAAzBA,IACDA,KAAKC,UAALD,CAAgBA,KAAKG,MAArBH,EAA6Bc,OAA7Bd,CAAqCe,CAArCf,CALEA,EAQDA,KAAKE,KAALF,CAAWW,MAAXX,GAAoB,CAApBA,IACDA,KAAKE,KAALF,CAAWY,GAAXZ,CAAea;AAAAA,iBAAQA,EAAKC,OAALD,CAAaE,CAAbF,CAARA;AAAAA,SAAfb,CATEA,EAYJA,KAAKkB,QAALlB,EAZIA;AAeNkB;AAmDF;AAAA;AAAA,aAnDEA,qBAGAZ;AAgDF;AAAA;AAAA,aAhDEA,yBAIAG;AA4CF;AAAA;AAAA,aA5CEA,+BAIAU;AAwCF;AAAA;AAAA,aAxCEA;AACE,YAAIC,IAAW,EAAf;AAaA,eAZGpB,KAAKC,UAALD,CAAgBW,MAAhBX,GAAyB,CAAzBA,KACDoB,IAAapB,KAAKC,UAALD,CAAgBA,KAAKG,MAArBH,EAA6BmB,QAA7BnB,EADZA,GAMAA,KAAKE,KAALF,CAAWW,MAAXX,GAAoB,CAApBA,KACDoB,IAAapB,KAAKE,KAALF,CAAWY,GAAXZ,CAAea;AAAAA,iBAAQA,EAAKM,QAALN,EAARA;AAAAA,SAAfb,EAAwCqB,IAAxCrB,CAA6C,EAA7CA,CADZA,CANAA,4BAaSA,KAAKD,IAbdC,wBAcGoB,CAdHpB,yBAYH;AAQFsB;AAkBF;AAAA;AAAA,aAlBEA;AAAAA;;AAUEtB,aAAKgB,EAALhB,CAAQuB,SAARvB,GAAmBA,KAAKmB,QAALnB,EAAnBA,EACAwB,sBAAsB;AAAA,iBAAKxB,MAAKc,OAALd,EAAL;AAAA,SAAtBwB,CADAxB;AACgCc;AAOpC;;AAAA;AAAA,KD/CA;;ME5CaW;;;;;AAEX5B,sBAAoBC;AAAAA;;AAAAA,UAANC,CAAMD,SAARC,IAAQD;AAAAA,oBAAFA,KAAEA;;AAAAA;;AAClB4B,iCAAM;AAAE3B,eAAF;AAAQD;AAAR,OAAN4B,GACA1B,OAAKE,KAALF,GAAa,EADb0B,EAEA1B,OAAKE,KAALF,CAAW2B,IAAX3B,CAAgB,IAAI4B,CAAJ,CAAmB;AAAE7B,cAAO,gBAAT;AAA2BD;AAA3B,OAAnB,CAAhBE,CAFA0B,EAGA1B,OAAKE,KAALF,CAAW2B,IAAX3B,CAAgB,IAAI6B,CAAJ,CAAa;AAAE9B,cAAO,UAAT;AAAsBD;AAAtB,OAAb,CAAhBE,CAHA0B,EAIA1B,OAAKE,KAALF,CAAW2B,IAAX3B,CAAgB,IAAI8B,CAAJ,CAAe;AAAE/B,cAAO,YAAT;AAAuBD;AAAvB,OAAf,CAAhBE,CAJA0B;AADkB5B;AAKoCA;;;IAPxBF;;MAYrBgC;;;;;AAIX/B,sBAAoBC;AAAAA;;AAAAA,UAANC,CAAMD,SAARC,IAAQD;AAAAA,oBAAFA,KAAEA;;AAAAA;;AAClB4B,mCAAM;AAAE3B,eAAF;AAAQD;AAAR,OAAN4B,sEACA1B,OAAKE,KAALF,GAAa,EADb0B,EAEA1B,OAAKE,KAALF,CAAW2B,IAAX3B,CAAiB,IAAI+B,CAAJ,CAAW;AAAEhC,cAAO,QAAT;AAAoBD;AAApB,OAAX,CAAjBE,CAFA0B,EAGA1B,OAAKE,KAALF,CAAW2B,IAAX3B,CAAiB,IAAIgC,CAAJ,CAAY;AAAEjC,cAAM,QAAR;AAAkBD;AAAlB,OAAZ,CAAjBE,CAHA0B,EAIA1B,OAAKE,KAALF,CAAW2B,IAAX3B,CAAiB,IAAIiC,CAAJ,CAAa;AAAElC,cAAO,SAAT;AAAoBD;AAApB,OAAb,CAAjBE,CAJA0B,EAKA1B,OAAKE,KAALF,CAAW2B,IAAX3B,CAAiB,IAAIkC,CAAJ,CAAgB;AAAEnC,cAAO,YAAT;AAAuBD;AAAvB,OAAhB,CAAjBE,CALA0B;AADkB5B;AAMsCA;;;IAVxBF;;MAgBvBmC;;;;;;;;;;;;;aAGVZ;AAEC,wMADgBnB,KAAKF,KAALE,CAAWmC,MAAXnC,IAOe,EAN/B;AAM+B;;;;IAXPJ;;MAmBfoC;;;;;;;;;;;;;aAGXb;AACE,YAAMiB,IAASC,OAAOrC,KAAKF,KAALE,CAAWsC,IAAlBD,CAAf;AACA,oHAEoCD,CAFpC,8GAImC,MAAXA,CAAW,GAAG,UAAH,GAAgB,EAJnD,qDAKoC,OAAXA,CAAW,GAAI,UAAJ,GAAiB,EALrD,sDAMoC,OAAXA,CAAW,GAAI,UAAJ,GAAiB,EANrD;AAMqD;;;;IAX7BxC;;MAmBfqC;;;;;;;;;;;;;aAGXd;AACE,YAAMoB,IAAWvC,KAAKF,KAALE,CAAWwC,KAA5B;AACA,0PAMuB,UAAbD,CAAa,GAAO,UAAP,GAAoB,EAN3C,2GASuB,UAAbA,CAAa,GAAO,UAAP,GAAoB,EAT3C;AAS2C;;;;IAdlB3C;;MAsBhBsC;;;;;;;;;;;;;aAEXf;AACE,eAAO,8LAAP;AAAO;;;;IAHqBvB;;MAcnBiC;;;;;;;;;;;;;aAGXV;AAEE,YAAMsB,IAAQzC,KAAKF,KAALE,CAAW0C,IAAzB;AAAA,YACMC,IAA8B,OAApB3C,KAAKF,KAALE,CAAWD,IAAS,GAAI,mBAAJ,GAA0B,EAD9D;AAGA,2QASwB,MAAjB0C,EAAM9B,MAAW,GAAI,EAAJ,GAClB8B,EAAM7B,GAAN6B,CAAW,UAACG,CAAD,EAAOC,CAAP;AAAA,sDACMD,EAAKE,EADX,sCAECF,EAAKE,EAFN,cAEYF,EAAKE,EAFjB,wDAGiBF,EAAKG,KAHtB,yDAIkBJ,CAJlB,eAI8BC,EAAKI,MAJnC,oCAKHJ,EAAKK,IAALL,CAAUM,KAAVN,CAAgB,GAAhBA,EAAqB,CAArBA,CALG;AAAA,SAAXH,EAOCpB,IAPDoB,CAOM,EAPNA,CAVN;AAiBY;;;;IAzBc7C;;MA+BxBkC;;;;;AAEJjC,sBAAoBC;AAAAA;;AAAAA,UAANC,CAAMD,SAARC,IAAQD;AAAAA,oBAAFA,KAAEA;;AAAAA;;AAClB4B,kCAAM;AAAE3B,eAAF;AAAQD;AAAR,OAAN4B,GACA1B,OAAKE,KAALF,GAAa,EADb0B,EAEA1B,OAAKE,KAALF,CAAW2B,IAAX3B,CAAiB,IAAImD,CAAJ,CAAe;AAAEpD,cAAM,mBAAR;AAA6BD;AAA7B,OAAf,CAAjBE,CAFA0B,EAGA1B,OAAKE,KAALF,CAAW2B,IAAX3B,CAAiB,IAAIoD,CAAJ,CAAe;AAAErD,cAAM,YAAR;AAAsBD;AAAtB,OAAf,CAAjBE,CAHA0B;AADkB5B;AAIoCA;;;IANjCF;;MAWZwD;;;;;;;;;;;;;aAEXjC;AACE,eAAO,gFAAP;AAAO;;;;IAHqBvB;;MAanBuD;;;;;;;;;;;;;;;;;;;;;;;;;aAIXhC;AACE,0BAAqCnB,KAAKF,KAA1C;AAAA,YAAQuD,CAAR,eAAMA,IAAN;AAAA,YAAcf,CAAd,eAAYA,IAAZ;AAAA,YAAoBgB,CAApB,eAAkBA,KAAlB;AAAA,YAA2BZ,CAA3B,eAAyBA,IAAzB;AAAA,YACMa,CADN,GACalB,OAAOgB,CAAPhB,IAAe,CAD5B;AAAA,YAEMmB,CAFN,GAEanB,OAAOC,CAAPD,IAAaA,OAAOgB,CAAPhB,CAAbA,GAA4BA,OAAOiB,CAAPjB,CAFzC;AAKA,mEAEuB,MAAlBA,OAAOiB,CAAPjB,CAAkB,GAAI,sDAAJ,GAA6D,EAFpF,qBAGKkB,IAAO,wCAAPA,GAAkD,EAHvD,qBAIKC,IAAO,yCAAPA,GAAmD,EAJxD,qBAKKnB,OAAOiB,CAAPjB,KAAOiB,CAAWE,CAAlBnB,GAAyB,iDAAzBA,GAA6E,EALlF;AAKkF;;;;IAftDzC;;AC/J/B,MAOD6D,IAPoB;AAClBC,WAAQ,CADU;AAElBC,YAFkB,oBAETD,CAFS,EAETA;AACP1D,WAAK0D,KAAL1D,GAAa0D,CAAb1D;AAAa0D;AAHG,GAAnB;;MCEYE;;;;;AAIX/D,sBAAoBC;AAAAA;;AAAAA,UAANC,CAAMD,SAARC,IAAQD;AAAAA,oBAAFA,KAAEA;;AAAAA;;AAClB4B,oCAAM;AAAE3B,eAAF;AAAQD;AAAR,OAAN4B,sEAEA1B,OAAKE,KAALF,GAAa,EAFb0B,EAGA1B,OAAKE,KAALF,CAAW2B,IAAX3B,CAAiB,IAAI6D,CAAJ,CAAW;AAAE9D,cAAO,QAAT;AAAmBD;AAAnB,OAAX,CAAjBE,CAHA0B,EAIA1B,OAAKE,KAALF,CAAW2B,IAAX3B,CAAiB,IAAI8D,CAAJ,CAAa;AAAE/D,cAAO,UAAT;AAAqBD;AAArB,OAAb,CAAjBE,CAJA0B,EAKA1B,OAAKE,KAALF,CAAW2B,IAAX3B,CAAiB,IAAI+D,CAAJ,CAAiB;AAAEhE,cAAO,cAAT;AAAyBD;AAAzB,OAAjB,CAAjBE,CALA0B;AADkB5B;AAMyCA;;;IAV3BF;;MAiBvBiE;;;;;;;;;;;;;aAGX1C;AAGE,YAAMuC,IAAQD,OAAd;AAAA,YACMf,IAAO1C,KAAKF,KAALE,CAAW0C,IAAX1C,CAAgBmC,MAAhBnC,CAAuBgE;AAAAA,iBAAOA,EAAIlB,EAAJkB,KAAY3B,OAAOqB,CAAPrB,CAAnB2B;AAAAA,SAAvBhE,EAAyD,CAAzDA,CADb;AAGA,kBAAK0C,CAAL,IAA6B,MAAhBA,EAAK/B,MAAlB,0TAUe+B,EAAKI,EAVpB,sCAWeJ,EAAKK,KAXpB,sCAYeL,EAAKM,MAZpB,sCAaeN,EAAKO,IAALP,CAAUQ,KAAVR,CAAgB,GAAhBA,EAAqB,CAArBA,CAbf;AAaoC;;;;IAtBZ9C;;MA+BfkE;;;;;;;;;;;;;aAGX3C;AACE,YAAMuC,IAAQD,OAAd;AAGA,2HAFazD,KAAKF,KAALE,CAAW0C,IAAX1C,CAAgBmC,MAAhBnC,CAAuBgE;AAAAA,iBAAOA,EAAIlB,EAAJkB,KAAY3B,OAAOqB,CAAPrB,CAAnB2B;AAAAA,SAAvBhE,EAAyD,CAAzDA,EAIqDiE,OAFlE;AAEkEA;;;;IATxCrE;;MAgBjBmE;;;;;;;;;;;;;aAIX5C;AACE,eAAO,qMAAP;AAAO;;;;IALuBvB;;ACpDlC;AAAA;;AAAA;;AAREC,4BAAoBC;AAAAA;;AAAAA,UAANC,CAAMD,SAARC,IAAQD;AAAAA,oBAAFA,KAAEA;;AAAAA;;AAClB4B,mCAAM;AAAE3B,eAAF;AAAQD;AAAR,OAAN4B,GACA1B,OAAKC,UAALD,CAAgB2B,IAAhB3B,CAAqB,IAAIyB,CAAJ,CAAiB;AAAE1B,cAAO,cAAT;AAA0BD;AAA1B,OAAjB,CAArBE,CADA0B,EAEA1B,OAAKC,UAALD,CAAgB2B,IAAhB3B,CAAqB,IAAI4D,CAAJ,CAAmB;AAAE7D,cAAM,YAAR;AAAsBD;AAAtB,OAAnB,CAArBE,CAFA0B;AADkB5B;AAG4CA;;AAKlE;AAAA,IAVkBF,CAUlB,GAAuB;AAAEG,UAAO;AAAT,GAAvB;;ACTO,WAASmE,CAAT,CAAwBC,CAAxB,EAAwBA;AAC7B,WAAO,IAAIC,OAAJ;AAAA,0EAAYC,iBAAOC,CAAPD,EAAgBE,CAAhBF;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAEXG,iBAFWH,GAEWF,CAFXE,CAEbG,GAFaH,EAENvE,CAFMuE,GAEWF,CAFXE,CAERvE,KAFQuE,EAECX,CAFDW,GAEWF,CAFXE,CAEDX,KAFCW;AAIXI,iBAJWJ,GAIH;ANPhBxE;AAAAA;;AAAAA;;AAAAA;;AAAAA;;AACEG,yBAAK0E,YAAL1E,GAAoB,EAApBA;AAGF2E;;AMGgB;AAAA;AAAA,2BNHhBA,mBAAUC,CAAVD,EAAUC;AACR5E,2BAAK4E,GAAL5E,GAAU4E,CAAV5E;AAGF6E;AMDgB;AAAA;AAAA,2BNChBA,mBAAUC,CAAVD,EAA0B;AAAA,0BAAPE,CAAO,uEAAPA,CAAO;AACxB/E,2BAAKF,KAALE,GAAa8E,CAAb9E;AAOFU;AMTgB;AAAA;AAAA,2BNShBA,kBAASsE,CAATtE,EAASsE;AACPhF,2BAAKF,KAALE,mCAAkBA,KAAKF,KAAvBE,GAAiCgF,CAAjChF,GAEAiF,QAAQC,SAARD,CAAkB;AAAEnF,+BAAQE,KAAKF;AAAf,uBAAlBmF,EAA0C,IAA1CA,EAAgDE,SAASC,MAATD,GAAkB,QAAlBA,GAA6BnF,KAAK0E,YAAL1E,CAAkBqF,UAAlBrF,EAA7EiF,CAFAjF,EAIAA,KAAKsF,UAALtF,EAJAA;AAUFsF;AMpBgB;AAAA;AAAA,2BNoBhBA;AAC+C,4BAA1CtG,OAAOuG,IAAPvG,CAAYgB,KAAK0E,YAAjB1F,EAA+B2B,MAAW,IAAGX,KAAK0E,YAAL1E,CAAkBwF,WAAlBxF,EAAH,EAC7CA,KAAKyF,SAALzF,EAD6C;AAI/CyF;AMzBgB;AAAA;AAAA,2BNyBhBA;AAEEzF,2BAAK4E,GAAL5E,CAASsB,MAATtB;AAGF0F;AM9BgB;AAAA;AAAA,2BN8BhBA,iBAAQV,CAARU,EAAQV;AACNhF,2BAAKF,KAALE,GAAagF,CAAbhF;AAAagF;AM/BC;;AAAA;AAAA,sBAJGX,EAKXsB,CALWtB,GAKF;ACPjBxE;AAAAA;;AAAAA;;AAAAA;;AAAAA;;AAAAA;;AAAAA;;AAAAA;;AAAAA;;AAEEG,yBAAK4F,GAAL5F,GAAW,CAAXA,EACAA,KAAK6F,UAAL7F,GAAkB;AAAEL,6BAAQ;AAAV,qBADlBK;AAKF2E;;ADAiB;AAAA;AAAA,2BCAjBA,mBAAUC,CAAVD,EAAUC;AACR5E,2BAAK4E,GAAL5E,GAAW4E,CAAX5E;AAGF8F;ADJiB;AAAA;AAAA,2BCIjBA,mBAAWC,CAAXD,EAAWC;AACT/F,2BAAK+F,MAAL/F,GAAc+F,CAAd/F;AAGFc;ADRiB;AAAA;AAAA,2BCQjBA,iBAAQC,CAARD,EAAQC;AACFf,2BAAKe,IAALf,IAAce,CAAdf,KAAoBA,KAAKe,IAALf,GAAYgG,SAAS/E,aAAT+E,CAAuB,OAAvBA,CAAhChG,GACAA,KAAKe,IAALf,KAAWA,KAAKe,IAALf,GAAYe,CAAvBf,CADAA;;AAGJ;AACEA,6BAAK4E,GAAL5E,CAASc,OAATd,CAAiBA,KAAKe,IAAtBf,GACAA,KAAK4E,GAAL5E,CAASiG,MAATjG,EADAA;AAID,uBALD,CAKC,OAAMkG,CAAN,EAAMA;AACL,4BAAGA,aAAeC,SAAlB,EACE,OAAOnG,KAAKoG,YAALpG,EAAP;AAAYoG;AAMlBzC;ADzBiB;AAAA;AAAA,2BCyBjBA,kBAASD,CAATC,EAASD;AACP1D,2BAAK0D,KAAL1D,GAAYqC,OAAOqB,CAAPrB,CAAZrC;AAGFqG;AD7BiB;AAAA;AAAA,2BC6BjBA,oBAAWC,CAAXD,EAAgC;AAAA,0BAAbD,CAAa,uEAAbA,CAAa;AAE9BE,0BAAoB,YAAXA,CAAW,GAAU,GAAV,GAAgBA,CAApCA,EACAtG,KAAK4F,GAAL5F,GAAWA,KAAK+F,MAAL/F,CAAYmC,MAAZnC,CACTuG;AAAAA,+BAASA,EAAMC,IAAND,KAAeD,CAAxBC;AAAAA,uBADSvG,EACwB,CADxBA,EAC2ByG,WAFtCH,EAIAtG,KAAK4E,GAAL5E,CAASG,MAATH,GAAkBA,KAAK4F,GAJvBU,EAMGF,KACHpG,KAAK0G,cAAL1G,EAPAsG;AAWFI;AD1CiB;AAAA;AAAA,2BC0CjBA;AACE1G,2BAAKe,IAALf,CAAUuB,SAAVvB,GAAsBA,KAAK4E,GAAL5E,CAASmB,QAATnB,EAAtBA,EACAA,KAAKc,OAALd,CAAaA,KAAKe,IAAlBf,CADAA;AAIFoG;AD/CiB;AAAA;AAAA,2BC+CjBA;AAEE,6BAAOpG,KAAK4E,GAAL5E,CAASmB,QAATnB,EAAP;AAAgBmB;ADjDD;;AAAA;AAAA,sBALEkD;AAOjBsB,kBAAOhB,SAAPgB,CAAiBgB,CAAjBhB,GACAA,EAAOG,SAAPH,CACE,CACE;AAAEa,wBAAO,GAAT;AACEC,+BAAc;AADhB,iBADF,EAIE;AAAED,wBAAO,cAAT;AACEC,+BAAc;AADhB,iBAJF,EAOE;AAAED,wBAAO,YAAT;AACEC,+BAAc;AADhB,iBAPF,EAUE;AACED,wBAAO,aADT;AAEEC,+BAAc;AAFhB,iBAVF,CADFd,CADAA,EAkBAnB,IAA4B,MAAtB1E,EAAM4C,IAAN5C,CAAWa,MAAW,GAAI,YAAJ,GAAmB6D,CAlB/CmB,EAmBAA,EAAOU,UAAPV,CAAkBnB,CAAlBmB,EAAkBnB,CAAK,CAAvBmB,CAnBAA,EAoBAlC,WAAoBpB,OAAOqB,CAAPrB,CAApB,CApBAsD,EAqBAlB,EAAMI,SAANJ,CAAgB3E,CAAhB2E,EAAgB3E,CAAO,CAAvB2E,CArBAkB,EAsBAgB,WAAa7G,CAAb,CAtBA6F;AAwBIiB,iBA/BavC,GA+BHsB,EAAOS,YAAPT,EA/BGtB;AAiCduC,oBAAUtC,EAASsC,CAATtC,CAAVsC,IAEDjB,EAAOU,UAAPV,CAAkB,YAAlBA,EAAkB,CAAc,CAAhCA,GACAiB,IAAWjB,EAAOS,YAAPT,EADXA,EAGGiB,IAAUtC,EAAQsC,CAARtC,CAAVsC,GACErC,EAAQ,IAAIsC,KAAJ,CAAU,WAAV,CAARtC,CANJqC;;AAjCcvC;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA;AAAAA,OAAZ;;AAAA;AAAA;AAAA;AAAA,QAAP;;;;;;;;;;;;;;;;;;;;;;;AENF,IAAMyC,GAAG,GAAG,CAAC,CAAD,EAAI,EAAJ,EAAQ,EAAR,EAAY,EAAZ,EAAgB,GAAhB,EAAqB,GAArB,EAA0B,GAA1B,CAAZ;;AACA,IAAOC,OAAO,GAAG,SAAVA,OAAU,GAAqB;AAAA,MAApBC,UAAoB,uEAAP,EAAO;AACpC,SAAO,IAAIC,KAAJ,CAAUD,UAAV,EAAsBE,IAAtB,CAA2B,CAA3B,EAA8BtG,GAA9B,CAAkC,UAACoD,GAAD,EAAMnB,GAAN,EAAc;AACrD,QAAIsE,GAAG,GAAGtE,GAAG,GAAG,CAAhB;AACA,QAAMuE,GAAG,GAAGD,GAAG,IAAI,EAAP,GAAY,CAAZ,GAAgBA,GAAG,IAAI,EAAP,GAAY,CAAZ,GAAgBA,GAAG,IAAI,EAAP,GACxC,CADwC,GACpCA,GAAG,IAAI,GAAP,GAAa,CAAb,GAAiBA,GAAG,IAAI,GAAP,GAAa,CAAb,GAAiBA,GAAG,IAAI,GAAP,GAAa,CAAb,GAAiB,CAD3D;AAEA,WAAO;AACLrE,MAAAA,EAAE,EAAGD,GAAG,GAAC,CADJ;AAELE,MAAAA,KAAK,iBAAWF,GAAG,GAAC,CAAf,CAFA;AAGLG,MAAAA,MAAM,gBAAUH,GAAG,GAAC,CAAd,CAHD;AAILoB,MAAAA,OAAO,mBAAapB,GAAG,GAAC,CAAjB,CAJF;AAKLI,MAAAA,IAAI,iBAAWmE,GAAX,cAAkBD,GAAG,GAACL,GAAG,CAACM,GAAG,GAAC,CAAL,CAAzB;AALC,KAAP;AAOD,GAXM,CAAP;AAYD,CAbD;;AAcA,IAAIC,OAAO,GAAGN,OAAO,CAAC,GAAD,CAArB;AAEAO,MAAM,CAAC1I,OAAP,GAAiByI,OAAjB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjBA,IAAIE,GAAG,GAAGC,mBAAO,CAAC,gCAAD,CAAjB;;AACA,IAAIH,OAAO,GAAGE,GAAd;AAEA,IAAIE,YAAY,GAAG;AACjB/E,EAAAA,IAAI,EAAG2E,OAAO,CAACK,KAAR,GAAgBC,OAAhB,GAA0BD,KAA1B,CAAgC,CAAhC,EAAkC,CAAlC,CADU;AAEjBrE,EAAAA,IAAI,EAAG,CAFU;AAGjBf,EAAAA,IAAI,EAAG,CAHU;AAIjBE,EAAAA,KAAK,EAAG,KAJS;AAKjBL,EAAAA,MAAM,EAAG,EALQ;AAMjBpC,EAAAA,IAAI,EAAG,EANU;AAOjBuD,EAAAA,KAAK,EAAG+D,OAAO,CAAC1G,MAPC;AAQjB+C,EAAAA,KAAK,EAAG;AARS,CAAnB,EAWA;;AACA,IAAMkE,aAAa,GAAG;AAEpB;AACAC,EAAAA,eAAe,EAAG,yBAACC,OAAD,EAA2B;AAAA,QAAjBpF,IAAiB,uEAAZ2E,OAAY;AAC3C;AACA;AACA,WAAOS,OAAO,KAAK,EAAZ,GACLpF,IADK,GAELA,IAAI,CAACP,MAAL,CAAa,UAAA6B,GAAG,EAAG;AACjB,UAAI+D,IAAI,GAAG,KAAX;;AACA,yCAAuB/I,MAAM,CAACgJ,OAAP,CAAehE,GAAf,CAAvB,qCAA2C;AAAvC;AAAA,YAAMlF,GAAN;AAAA,YAAUmJ,GAAV;;AACF,YAAGnJ,GAAG,KAAK,IAAR,IAAgBA,GAAG,KAAI,MAAvB,IAAiCA,GAAG,KAAK,OAA5C,EAAqD,SADZ,CAEzC;;AACA,YAAG,CAACoJ,MAAM,CAACD,GAAD,CAAN,CAAYE,QAAZ,CAAqBL,OAArB,CAAJ,EAAmC;AACnCC,QAAAA,IAAI,GAAG,IAAP,CAJyC,CAKzC;;AACA;AACD;;AACD,aAAOA,IAAP;AACH,KAXC,CAFF;AAcD,GApBmB;AAsBpB;AACAK,EAAAA,YAAY,EAAG,sBAACrI,IAAD,EAAO2C,IAAP,EAAgB;AAC7B;AACA;AAEA,WAAQ3C,IAAI,KAAK,EAAT,GACN2C,IADM,GAENA,IAAI,CAACP,MAAL,CAAa,UAAA6B,GAAG,EAAG;AACjB,UAAI+D,IAAI,GAAG,KAAX;;AACA,2CAAuB/I,MAAM,CAACgJ,OAAP,CAAehE,GAAf,CAAvB,wCAA2C;AAAvC;AAAA,YAAMlF,GAAN;AAAA,YAAUmJ,GAAV;;AACF,YAAGnJ,GAAG,KAAK,QAAR,IAAoBoJ,MAAM,CAACD,GAAD,CAAN,KAAgBlI,IAAvC,EAA6C;AAC3CgI,UAAAA,IAAI,GAAG,IAAP;AACA;AACD;AACF;;AACD,aAAOA,IAAP;AACH,KATC,CAFF;AAYD,GAvCmB;AAyCpB;AACAM,EAAAA,QAAQ,EAAG,kBAAChF,IAAD,EAAOf,IAAP,EAAagG,MAAb,EAAqBC,GAArB,EAA6B;AACtC;AACA,QAAIC,KAAK,GAAG,CAACnF,IAAI,GAAG,CAAR,IAAaf,IAAb,GAAoBgG,MAAhC;;AACAE,IAAAA,KAAK,GAAGA,KAAK,GAAG,CAAR,GAAY,CAAZ,GAAgBA,KAAxB;;AAEA,QAAIC,GAAG,GAAGD,KAAK,GAAGlG,IAAR,GAAegG,MAAzB;;AACAG,IAAAA,GAAG,GAAGA,GAAG,IAAIF,GAAP,GAAaA,GAAb,GAAmBE,GAAzB,CANsC,CAOtC;;AACA,WAAO,CAACD,KAAD,EAAQC,GAAR,EAAaF,GAAb,CAAP;AACD,GAnDmB;AAqDpB;AACAG,EAAAA,YAAY,EAAG,sBAAClG,KAAD,EAAQmG,KAAR,EAAkB;AAC/BA,IAAAA,KAAK,GAAGnG,KAAK,KAAK,KAAV,GAAkBmG,KAAK,CAAChB,OAAN,EAAlB,GAAoCgB,KAA5C;AAEA,WAAOA,KAAK,CAACjB,KAAN,GACJ9G,GADI,CACA,UAACgC,IAAD,EAAOC,GAAP,EAAe;AACpBD,MAAAA,IAAI,CAAC,OAAD,CAAJ,GAAgBC,GAAhB;AACA,aAAOD,IAAP;AACD,KAJM,CAAP;AAKD;AA9DmB,CAAtB;AAgEA0E,MAAM,CAAC1I,OAAP,GAAiB;AACfgK,EAAAA,0BAA0B,EAAI,oCAAC9I,KAAD,EAAU;AACtC,iBAAsDA,KAAtD;AAAA,QAAKqC,MAAL,UAAKA,MAAL;AAAA,QAAapC,IAAb,UAAaA,IAAb;AAAA,QAAmByC,KAAnB,UAAmBA,KAAnB;AAAA,QAA0Ba,IAA1B,UAA0BA,IAA1B;AAAA,QAAgCf,IAAhC,UAAgCA,IAAhC;AAAA,QAAsCI,IAAtC,UAAsCA,IAAtC;AAAA,QAA4CY,KAA5C,UAA4CA,KAA5C;AAEAD,IAAAA,IAAI,GAAGhB,MAAM,CAACgB,IAAD,CAAb;AAAqBf,IAAAA,IAAI,GAAED,MAAM,CAACC,IAAD,CAAZ,CAHiB,CAItC;;AACA,QAAIuG,QAAQ,GAAGjB,aAAa,CAACC,eAAd,CAA8B1F,MAA9B,CAAf,CALsC,CAMtC;;AAEA0G,IAAAA,QAAQ,GAAGjB,aAAa,CAACQ,YAAd,CAA2BrI,IAA3B,EAAiC8I,QAAjC,CAAX,CARsC,CAStC;;AAEA,gCAAmBjB,aAAa,CAACS,QAAd,CAAuBhF,IAAvB,EAA6Bf,IAA7B,EAAmC,CAAnC,EAAsCuG,QAAQ,CAAClI,MAA/C,CAAnB;AAAA;AAAA,QAAMmI,IAAN;AAAA,QAAYC,EAAZ;;AAEA,QAAIC,aAAa,GAAGpB,aAAa,CAACc,YAAd,CAA2BlG,KAA3B,EAAkCqG,QAAQ,CAACnB,KAAT,EAAlC,CAApB;AACAhF,IAAAA,IAAI,GAAGsG,aAAa,CAACtB,KAAd,CAAoBoB,IAApB,EAA0BC,EAA1B,CAAP;AACAzF,IAAAA,KAAK,GAAG0F,aAAa,CAACrI,MAAtB;AAEAb,IAAAA,KAAK,mCAAQA,KAAR;AAAe4C,MAAAA,IAAI,EAAJA,IAAf;AAAqBY,MAAAA,KAAK,EAALA;AAArB,MAAL,CAjBsC,CAkBtC;;AACA,WAAOxD,KAAP;AACD,GArBc;AAsBfmJ,EAAAA,UAAU,EAAG,oBAACnJ,KAAD,EAAW;AACtB,QAAQqC,MAAR,GAAyDrC,KAAzD,CAAQqC,MAAR;AAAA,QAAgBpC,IAAhB,GAAyDD,KAAzD,CAAgBC,IAAhB;AAAA,QAAsByC,KAAtB,GAAyD1C,KAAzD,CAAsB0C,KAAtB;AAAA,QAA6BE,IAA7B,GAAyD5C,KAAzD,CAA6B4C,IAA7B;AAAA,QAAmCY,KAAnC,GAAyDxD,KAAzD,CAAmCwD,KAAnC;AAAA,QAA0CD,IAA1C,GAAyDvD,KAAzD,CAA0CuD,IAA1C;AAAA,QAAgDf,IAAhD,GAAyDxC,KAAzD,CAAgDwC,IAAhD;AACA,QAAMQ,EAAE,oBAAaX,MAAb,mBAA4BpC,IAA5B,oBAA0CyC,KAA1C,mBAAwDa,IAAxD,mBAAqEf,IAArE,CAAR;AAEA,WAAOQ,EAAP;AACD,GA3Bc;AA6BfoG,EAAAA,UAAU,EAAG,0BAAqC;AAAA,QAAjClG,MAAiC,QAAjCA,MAAiC;AAAA,QAAzBD,KAAyB,QAAzBA,KAAyB;AAAA,QAAjBkB,OAAiB,QAAjBA,OAAiB;AAAA,QAARnB,EAAQ,QAARA,EAAQ;AAChD;AACAuE,IAAAA,OAAO,GAAGA,OAAO,CAACzG,GAAR,CAAa,UAAAoD,GAAG,EAAI;AAE5B,UAAI3B,MAAM,CAAC2B,GAAG,CAAClB,EAAL,CAAN,KAAmBT,MAAM,CAACS,EAAD,CAA7B,EAAoC;AAClCkB,QAAAA,GAAG,CAAChB,MAAJ,GAAaA,MAAb;AACAgB,QAAAA,GAAG,CAACjB,KAAJ,GAAYA,KAAZ;AACAiB,QAAAA,GAAG,CAACC,OAAJ,GAAcA,OAAd;AACD;;AACD,aAAOD,GAAP;AACD,KARS,CAAV,CAFgD,CAWhD;;AACA,WAAOqD,OAAP;AACD,GA1Cc;AA4Cf8B,EAAAA,UAAU,EAAG,2BAAiC;AAAA,QAA7BnG,MAA6B,SAA7BA,MAA6B;AAAA,QAArBD,KAAqB,SAArBA,KAAqB;AAAA,QAAdkB,OAAc,SAAdA,OAAc;AAC5C,QAAMnB,EAAE,GAAGuE,OAAO,CAACA,OAAO,CAAC1G,MAAR,GAAgB,CAAjB,CAAP,CAA2BmC,EAA3B,GAAgC,CAA3C;AACAuE,IAAAA,OAAO,CAAC1F,IAAR,CAAa;AACXmB,MAAAA,EAAE,EAAFA,EADW;AACPE,MAAAA,MAAM,EAANA,MADO;AACCD,MAAAA,KAAK,EAALA,KADD;AACQkB,MAAAA,OAAO,EAAPA,OADR;AACiBhB,MAAAA,IAAI,EAAE,IAAImG,IAAJ,GAAWC,WAAX;AADvB,KAAb;AAGA,WAAOhC,OAAP;AACD,GAlDc;AAoDfiC,EAAAA,UAAU,EAAG,oBAAExG,EAAF,EAAU;AACrB,SAAI,IAAIyG,CAAC,GAAG,CAAZ,EAAgBA,CAAC,GAAGlC,OAAO,CAAC1G,MAA5B,EAAqC4I,CAAC,EAAtC,EAAyC;AACvC,UAAIlC,OAAO,CAACkC,CAAD,CAAP,CAAWzG,EAAX,KAAkBT,MAAM,CAACS,EAAD,CAA5B,EAAmCuE,OAAO,CAACmC,MAAR,CAAeD,CAAf,EAAiB,CAAjB;AACpC;;AACD,WAAOlC,OAAP;AACD,GAzDc;AA2DfoC,EAAAA,eAAe,EAAG,2BAAM;AACtBhC,IAAAA,YAAY,CAAC/E,IAAb,GAAoB2E,OAAO,CAACK,KAAR,GAAgBC,OAAhB,GAA0BD,KAA1B,CAAgC,CAAhC,EAAkC,CAAlC,CAApB;AACA,WAAOD,YAAP;AACD;AA9Dc,CAAjB;;;;;;;;;;;;;;;;;;;;;;;;;AC/EA,eAAgBD,mBAAO,CAAC,yCAAD,CAAvB;AAAA,IAAQkC,GAAR,YAAQA,GAAR;;AAEA,IAAMC,aAAa;AAAA,qEAAG,iBAAOxF,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACZrE,YAAAA,KADY,GACFqE,OADE,CACZrE,KADY,EAEpB;AACA;;AAHoB;AAAA,mBAIM4J,GAAG,CAACxF,aAAJ,CAAkBC,OAAlB,EAA2ByF,IAA3B,CAAgCC,MAAhC,CAJN;;AAAA;AAIdC,YAAAA,WAJc;AAKdD,YAAAA,MALc,GAKL1I,QAAQ,CAACrB,KAAD,EAAQgK,WAAR,CALH,EAMpB;AACA;;AAPoB,6CASb,CAACD,MAAD,GACH,iBADG,GAEHA,MAXgB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAbF,aAAa;AAAA;AAAA;AAAA,GAAnB;;AAeA,IAAMxI,QAAQ,GAAG,SAAXA,QAAW,CAACrB,KAAD,EAAQ8G,QAAR,EAAqB;AACpC,6RAQuBmD,IAAI,CAACC,SAAL,CAAelK,KAAf,CARvB,gEAYI8G,QAZJ;AAkBD,CAnBD;;AAqBAU,MAAM,CAAC1I,OAAP,GAAiB+K,aAAjB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ICrCMM;AAEJ,uBAAYnK,KAAZ,EAAkB;AAAA;;AAAA;;AAChB,SAAKA,KAAL,GAAaA,KAAb;AACD;;;;WACD,kBAASkF,QAAT,EAAkB;AAChB,WAAKlF,KAAL,mCAAkB,KAAKA,KAAvB,GAAiCkF,QAAjC;AACD;;;;;;AAKHsC,MAAM,CAAC1I,OAAP,GAAiB;AAAE6F,EAAAA,KAAK,EAAI,IAAIwF,WAAJ;AAAX,CAAjB;;;;;;;;;;ACbA;AACA,WAAW,mBAAO,CAAC,kBAAM;AACzB,aAAa,mBAAO,CAAC,sBAAQ;AAC7B,iBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,gBAAgB,sBAAsB;AACtC;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACtFA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;;;;;;;;;;;;;;;;;;;;;ACtBAzC,mBAAO,CAAC,oDAAD,CAAP;;AACA,IAAM0C,OAAO,GAAG1C,mBAAO,CAAC,wBAAD,CAAvB;;AACA,IAAM2C,IAAI,GAAG3C,mBAAO,CAAC,kBAAD,CAApB;;AACA,IAAM4C,EAAE,GAAE5C,mBAAO,CAAC,cAAD,CAAjB;;AACA,IAAMhB,IAAI,GAAGgB,mBAAO,CAAC,kBAAD,CAApB;;AACA,IAAMzC,MAAM,GAAGmF,OAAO,EAAtB;AACA,IAAMG,IAAI,GAAG,IAAb;;AAEA,IAAMV,aAAa,GAAGnC,mBAAO,CAAC,kDAAD,CAA7B;;AACA,eAAkBA,mBAAO,CAAC,sCAAD,CAAzB;AAAA,IAAQ/C,KAAR,YAAQA,KAAR;;AACA,gBAII+C,mBAAO,CAAC,4CAAD,CAJX;AAAA,IACEoB,0BADF,aACEA,0BADF;AAAA,IAEEK,UAFF,aAEEA,UAFF;AAAA,IAEcQ,eAFd,aAEcA,eAFd;AAAA,IAGEP,UAHF,aAGEA,UAHF;AAAA,IAGcC,UAHd,aAGcA,UAHd;AAAA,IAG0BG,UAH1B,aAG0BA,UAH1B;;AAMAvE,MAAM,CAACuF,OAAP,CAAe,GAAf,EAAoBH,IAAI,EAAxB;AACApF,MAAM,CAACwF,GAAP,CAAWL,OAAO,CAACM,IAAR,EAAX;AACAzF,MAAM,CAACwF,GAAP,CAAWL,OAAO,CAACO,UAAR,CAAmB;AAAEC,EAAAA,QAAQ,EAAG;AAAb,CAAnB,CAAX;AACA3F,MAAM,CAACwF,GAAP,CAAWL,OAAO,UAAP,CAAe1D,IAAI,CAAClC,OAAL,CAAaqG,SAAb,EAAwB,QAAxB,CAAf,CAAX;;AAEA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,GAAD,EAAMC,GAAN,EAAc;AAChC,MAAG,CAACD,GAAG,CAACE,KAAR,EAAe,OAAOD,GAAG,CAACE,MAAJ,CAAW,GAAX,EAAgBzC,GAAhB,EAAP;AAEf9D,EAAAA,KAAK,CAAC/D,QAAN,CAAekI,0BAA0B,CAACiC,GAAG,CAACE,KAAL,CAAzC;AACA,qBAAwBtG,KAAK,CAAC3E,KAA9B;AAAA,MAAQ4C,IAAR,gBAAQA,IAAR;AAAA,MAAcY,KAAd,gBAAcA,KAAd;AAEAwH,EAAAA,GAAG,CAACN,IAAJ,CAAS;AAAE1H,IAAAA,EAAE,EAAGmG,UAAU,CAACxE,KAAK,CAAC3E,KAAP,CAAjB;AAAgC4C,IAAAA,IAAI,EAAJA,IAAhC;AAAsCY,IAAAA,KAAK,EAALA;AAAtC,GAAT;AACD,CAPD;;AASA,IAAM2H,WAAW;AAAA,qEAAG,iBAAOJ,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA,gBACbD,GAAG,CAACK,IADS;AAAA;AAAA;AAAA;;AAAA,6CACKJ,GAAG,CAACE,MAAJ,CAAW,GAAX,EAAgBzC,GAAhB,EADL;;AAAA;AAElB9D,YAAAA,KAAK,CAAC/D,QAAN,CAAemK,GAAG,CAACK,IAAnB;AAFkB,6CAGXJ,GAAG,CAACE,MAAJ,CAAW,GAAX,EAAgBzC,GAAhB,EAHW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAAX0C,WAAW;AAAA;AAAA;AAAA,GAAjB;;AAMAlG,MAAM,CAAC5F,GAAP,CAAW,GAAX;AAAA,sEAAgB,kBAAO0L,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AACdrG,YAAAA,KAAK,CAAC/D,QAAN,CAAe+I,eAAe,EAA9B,EADc,CAEd;;AACM0B,YAAAA,UAHQ,GAGK,WAAWlC,UAAU,CAACxE,KAAK,CAAC3E,KAAP,CAH1B;AAAA,8CAKPgL,GAAG,CAACM,QAAJ,CAAaD,UAAb,CALO;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAhB;;AAAA;AAAA;AAAA;AAAA;AAQApG,MAAM,CAAC5F,GAAP,CAAW,OAAX;AAAA,sEAAoB,kBAAO0L,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAElB,gBAAI,CAACrG,KAAK,CAAC3E,KAAX,EAAmB2E,KAAK,CAAC/D,QAAN,CAAe+I,eAAe,EAA9B,EAFD,CAGlB;;AACM4B,YAAAA,QAJY,GAID,UAAUpC,UAAU,CAAC4B,GAAG,CAACE,KAAL,CAJnB;AAKZO,YAAAA,OALY,GAKF9E,IAAI,CAAClC,OAAL,CAAaqG,SAAb,EAAuB,wBAAvB,EAAkD,WAAUU,QAAV,GAAoB,OAAtE,CALE;;AAAA,gBAOZjB,EAAE,CAACmB,UAAH,CAAcD,OAAd,CAPY;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAQD3B,aAAa,CAAC;AAAEnF,cAAAA,GAAG,EAAG,GAAR;AAAa1E,cAAAA,KAAK,EAAG2E,KAAK,CAAC3E,KAA3B;AAAkC4D,cAAAA,KAAK,EAAG;AAA1C,aAAD,CARZ;;AAAA;AAQd8H,YAAAA,IARc;AAAA;AAAA,mBASRpB,EAAE,CAACqB,aAAH,CAAiBH,OAAjB,EAA0BE,IAA1B,CATQ;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mBAYDpB,EAAE,CAACsB,YAAH,CAAgBJ,OAAhB,EAAyB,OAAzB,CAZC;;AAAA;AAYdE,YAAAA,IAZc;;AAAA;AAAA,8CAeXV,GAAG,CAACa,IAAJ,CAASH,IAAT,CAfW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAApB;;AAAA;AAAA;AAAA;AAAA;AAkBAzG,MAAM,CAAC5F,GAAP,CAAW,cAAX;AAAA,sEAA2B,kBAAO0L,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AACjBpH,YAAAA,KADiB,GACPmH,GAAG,CAACE,KADG,CACjBrH,KADiB;AAAA;AAAA,mBAEJiG,aAAa,CAAC;AAAEnF,cAAAA,GAAG,EAAG,cAAR;AAAwB1E,cAAAA,KAAK,EAAG2E,KAAK,CAAC3E,KAAtC;AAA6C4D,cAAAA,KAAK,EAALA;AAA7C,aAAD,CAFT;;AAAA;AAEnBmG,YAAAA,MAFmB;AAAA,8CAIlBiB,GAAG,CAACa,IAAJ,CAAS9B,MAAT,CAJkB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA3B;;AAAA;AAAA;AAAA;AAAA;AAOA9E,MAAM,CAAC5F,GAAP,CAAW,YAAX,EAAyByL,WAAzB;AACA7F,MAAM,CAAC6G,GAAP,CAAW,YAAX,EAAyBX,WAAzB;AAGAlG,MAAM,CAAC8G,IAAP,CAAY,YAAZ,EAA0B,UAAChB,GAAD,EAAMC,GAAN,EAAc;AACtC,MAAGD,GAAG,CAACK,IAAJ,CAASpI,EAAT,KAAgB,EAAnB,EAAsB;AACpB,QAAG,CAACqG,UAAU,CAAC0B,GAAG,CAACK,IAAL,CAAd,EACE,OAAOJ,GAAG,CAACE,MAAJ,CAAW,GAAX,EAAgBW,IAAhB,CAAqB,uBAArB,CAAP;AAEFlH,IAAAA,KAAK,CAAC/D,QAAN,CAAgBkI,0BAA0B,CACxC;AAAEzG,MAAAA,MAAM,EAAG,EAAX;AAAeK,MAAAA,KAAK,EAAG,KAAvB;AAA8BzC,MAAAA,IAAI,EAAG,EAArC;AAA0CsD,MAAAA,IAAI,EAAG,CAAjD;AAAoDf,MAAAA,IAAI,EAAG;AAA3D,KADwC,CAA1C;AAIA,WAAOwI,GAAG,CAACN,IAAJ,CAAS/F,KAAK,CAAC3E,KAAf,CAAP;AACD;;AAED,MAAI,CAACoJ,UAAU,CAAC2B,GAAG,CAACK,IAAL,CAAf,EACE,OAAOJ,GAAG,CAACE,MAAJ,CAAW,GAAX,EAAgBW,IAAhB,CAAqB,uBAArB,CAAP;AAEF,MAAM5L,IAAI,GAAG0E,KAAK,CAAC3E,KAAN,CAAYC,IAAZ,KAAqB,EAArB,GAA0B8K,GAAG,CAACK,IAAJ,CAASlI,MAAnC,GAA4C,EAAzD;AACAyB,EAAAA,KAAK,CAAC/D,QAAN,CAAe;AAAEX,IAAAA,IAAI,EAAJA;AAAF,GAAf;AACA0E,EAAAA,KAAK,CAAC/D,QAAN,CAAgBkI,0BAA0B,CAACnE,KAAK,CAAC3E,KAAP,CAA1C;AAEA,SAAOgL,GAAG,CAACN,IAAJ,CAAS/F,KAAK,CAAC3E,KAAf,CAAP;AACD,CApBD;AAsBAiF,MAAM,UAAN,CAAc,cAAd,EAA8B,UAAC8F,GAAD,EAAKC,GAAL,EAAa;AAEzC;AACA,MAAI,CAACxB,UAAU,CAACuB,GAAG,CAACE,KAAJ,CAAUjI,EAAX,CAAf,EACE,OAAOgI,GAAG,CAACE,MAAJ,CAAW,GAAX,EAAgBW,IAAhB,CAAqB,uBAArB,CAAP;AAEFlH,EAAAA,KAAK,CAAC/D,QAAN,CAAgBkI,0BAA0B,CACxC;AAAEzG,IAAAA,MAAM,EAAG,EAAX;AAAeK,IAAAA,KAAK,EAAG,KAAvB;AAA8BzC,IAAAA,IAAI,EAAG,EAArC;AAA0CsD,IAAAA,IAAI,EAAG,CAAjD;AAAoDf,IAAAA,IAAI,EAAG;AAA3D,GADwC,CAA1C;AAIA,SAAOwI,GAAG,CAACE,MAAJ,CAAW,GAAX,EAAgBR,IAAhB,CAAqB/F,KAAK,CAAC3E,KAA3B,CAAP;AACD,CAXD;AAcAiF,MAAM,CAAC+G,MAAP,CAAczB,IAAd,EAAoB,YAAK;AACvB0B,EAAAA,OAAO,CAACC,GAAR,CAAY,8BAA4B3B,IAAxC;AACD,CAFD","sources":["webpack://server/SSR/webpack/bootstrap","webpack://server/SSR/webpack/runtime/define property getters","webpack://server/SSR/webpack/runtime/hasOwnProperty shorthand","webpack://server/SSR/webpack/runtime/make namespace object","webpack://server/SSR/./src/lib/Store.js","webpack://server/SSR/./src/lib/Component.js","webpack://server/SSR/./src/views/PostListPage.js","webpack://server/SSR/./src/views/router.js","webpack://server/SSR/./src/views/PostSingle.js","webpack://server/SSR/./src/views/App.js","webpack://server/SSR/./ssr.js","webpack://server/SSR/./src/lib/Router.js","webpack://server/./src/Data.js","webpack://server/./src/executor.js","webpack://server/./src/ssr.service.js","webpack://server/./src/store.js","webpack://server/./node_modules/console-browserify/index.js","webpack://server/external commonjs \"assert\"","webpack://server/external commonjs \"core-js/modules/es.array.concat.js\"","webpack://server/external commonjs \"core-js/modules/es.array.fill.js\"","webpack://server/external commonjs \"core-js/modules/es.array.filter.js\"","webpack://server/external commonjs \"core-js/modules/es.array.for-each.js\"","webpack://server/external commonjs \"core-js/modules/es.array.from.js\"","webpack://server/external commonjs \"core-js/modules/es.array.includes.js\"","webpack://server/external commonjs \"core-js/modules/es.array.is-array.js\"","webpack://server/external commonjs \"core-js/modules/es.array.iterator.js\"","webpack://server/external commonjs \"core-js/modules/es.array.join.js\"","webpack://server/external commonjs \"core-js/modules/es.array.map.js\"","webpack://server/external commonjs \"core-js/modules/es.array.reverse.js\"","webpack://server/external commonjs \"core-js/modules/es.array.slice.js\"","webpack://server/external commonjs \"core-js/modules/es.array.splice.js\"","webpack://server/external commonjs \"core-js/modules/es.date.to-iso-string.js\"","webpack://server/external commonjs \"core-js/modules/es.date.to-string.js\"","webpack://server/external commonjs \"core-js/modules/es.function.bind.js\"","webpack://server/external commonjs \"core-js/modules/es.function.name.js\"","webpack://server/external commonjs \"core-js/modules/es.json.to-string-tag.js\"","webpack://server/external commonjs \"core-js/modules/es.math.to-string-tag.js\"","webpack://server/external commonjs \"core-js/modules/es.number.constructor.js\"","webpack://server/external commonjs \"core-js/modules/es.object.create.js\"","webpack://server/external commonjs \"core-js/modules/es.object.define-properties.js\"","webpack://server/external commonjs \"core-js/modules/es.object.define-property.js\"","webpack://server/external commonjs \"core-js/modules/es.object.entries.js\"","webpack://server/external commonjs \"core-js/modules/es.object.get-own-property-descriptor.js\"","webpack://server/external commonjs \"core-js/modules/es.object.get-own-property-descriptors.js\"","webpack://server/external commonjs \"core-js/modules/es.object.get-prototype-of.js\"","webpack://server/external commonjs \"core-js/modules/es.object.keys.js\"","webpack://server/external commonjs \"core-js/modules/es.object.set-prototype-of.js\"","webpack://server/external commonjs \"core-js/modules/es.object.to-string.js\"","webpack://server/external commonjs \"core-js/modules/es.promise.js\"","webpack://server/external commonjs \"core-js/modules/es.reflect.construct.js\"","webpack://server/external commonjs \"core-js/modules/es.regexp.exec.js\"","webpack://server/external commonjs \"core-js/modules/es.string.includes.js\"","webpack://server/external commonjs \"core-js/modules/es.string.iterator.js\"","webpack://server/external commonjs \"core-js/modules/es.string.split.js\"","webpack://server/external commonjs \"core-js/modules/es.symbol.description.js\"","webpack://server/external commonjs \"core-js/modules/es.symbol.iterator.js\"","webpack://server/external commonjs \"core-js/modules/es.symbol.js\"","webpack://server/external commonjs \"core-js/modules/es.symbol.to-string-tag.js\"","webpack://server/external commonjs \"core-js/modules/web.dom-collections.for-each.js\"","webpack://server/external commonjs \"core-js/modules/web.dom-collections.iterator.js\"","webpack://server/external commonjs \"cors\"","webpack://server/external commonjs \"express\"","webpack://server/external commonjs \"global-jsdom/register\"","webpack://server/external commonjs \"regenerator-runtime/runtime.js\"","webpack://server/external commonjs \"util\"","webpack://server/external node-commonjs \"fs\"","webpack://server/external node-commonjs \"path\"","webpack://server/webpack/bootstrap","webpack://server/./server.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","class Store {\n  state; app; cacheHandler;\n\n  constructor(){\n    this.cacheHandler = {}; \n  }\n\n  subscribe(app){\n    this.app =app;\n  }\n\n  initState(initial, server=false){\n    this.state = initial;\n    if(server) return \n    // console.log(this.state)\n    // history.pushState({ state : this.state }, null, location.origin + '/page?' + this.cacheHandler.getCacheId())    \n\n  }\n\n  setState(newState){\n    this.state = { ...this.state, ...newState };\n    // console.log(this.cacheHandler.getCacheId())\n    history.pushState({ state : this.state }, null, location.origin + '/page?' + this.cacheHandler.getCacheId())    \n    // console.log(history)\n    this.updateView();\n    // const { filter, name, order, page, size, total }  = this.state\n    // const url = `/page?filter=${filter}&name=${name}&order=${order}&page=${page}&size=${size}&total=${total}`\n    // console.log('after setState=', this.state, location.origin + '/page?' + this.cacheHandler.getCacheId())\n  }\n\n  updateView(){\n    if(Object.keys(this.cacheHandler).length !== 0) this.cacheHandler.searchCache();\n    this.renderAll()\n  }\n\n  renderAll(){\n    // console.log('render All works')\n    this.app.render();\n  }\n\n  hydrate(newState){\n    this.state = newState\n  }\n\n}\n\nexport default Store;","class Component{\n  \n  el; components; child; firstBonder; secondBonder; name; curPos; oldPos; root; state\n\n  constructor({ name, state }){\n    this.components=[];\n    this.child =[];\n    this.name = name;\n    this.state = state;\n    this.curPos = 0;\n    this.oldPos = 0;    \n    \n    this.firstBonder = this.eventHandler.bind(this);\n    this.secondBonder = this.secondEventHandler.bind(this);\n  }\n  \n  setState(state){\n    this.state = state; // for serverside rendering\n    // console.log('=========================this.state, this.curPos',this.state, this.curPos)\n    if(this.components.length > 0){\n      this.components[this.curPos].setState(state)\n    }\n    if(this.child.length > 0){\n      this.child.map(node => node.setState(state))\n    }\n  }\n  setRoot(root){\n    if(!this.root)  this.root = root;\n    this.el =  this.root.querySelector(`#${this.name}`);\n    // console.log(\"setRooooot=\", this.root, this.el, this.name)\n    \n    if(this.components.length > 0){\n      this.components[this.curPos].setRoot(root);\n    }\n\n    if(this.child.length > 0){\n      this.child.map(node => node.setRoot(root));\n    }\n    // console.log(root, 'setRoot', this.el)\n    this.setEvent();\n  }\n  \n  setEvent(){\n  }\n\n  eventHandler(){\n\n  }\n\n  secondEventHandler(){\n    \n  }\n\n  template(){\n    let renderHtml='';\n    if(this.components.length > 0){\n      renderHtml = this.components[this.curPos].template();\n      // console.log('this app name=', this.name, this.state, renderHtml)\n\n    } \n\n    if(this.child.length > 0){\n      renderHtml = this.child.map(node => node.template()).join('')\n      // console.log('this app name=', this.name, this.state, renderHtml)\n\n    }\n    // console.log('this app name=', this.name, this.state, renderHtml)\n    return `\n      <div id=${this.name}>\n        ${renderHtml}\n      </div>\n    `;\n\n  }\n  \n  render(){\n    // console.log(this.root)\n    // if(!this.el) this.el = this.root.querySelector('#'+ this.name) \n    // console.log(this.root)\n    // const oldOne = this.el.innerHTML;\n    // const newOne = this.template();\n  // Needs\n    // console.log(newOne)\n    // some diff logic to compare of two\n \n    this.el.innerHTML= this.template() //(should be oldOne after diff);\n    requestAnimationFrame(()=> this.setRoot())\n      // console.log(\"rendering here =\", this.name, this.el)\n\n  }\n\n}\n\nexport default Component","import Component from '../lib/Component.js';\n\nexport class PostListPage extends Component{\n  \n  constructor({ name, state }){\n    super({ name, state })\n    this.child = [] \n    this.child.push(new PostListHeader({ name : 'postlistheader', state }))\n    this.child.push(new Postlist({ name : 'postlist' , state }))\n    this.child.push(new PageButton({ name : 'pagebutton', state }))\n  }\n  \n}\n\nexport class PostListHeader extends Component{\n  \n  child; \n\n  constructor({ name, state }){\n    super({ name, state })\n    this.child = []\n    this.child.push( new Search({ name : 'search' , state }) )\n    this.child.push( new Paging( { name :'paging', state  }) )\n    this.child.push( new Sorting( { name : 'sorting', state }) )\n    this.child.push( new SortButton( { name : 'sortbutton', state }) )\n\n  }\n\n}\n\nexport class Search extends Component{\n\n\n   template(){\n    const keyword = this.state.filter\n    return `\n    <div data-component=\"search\" id=\"search\">\n      <input \n        data-action='searchInput' \n        placeholder=\"search\" \n        type=\"text\" \n        value=${keyword? keyword : \"\"}>\n      <button data-action='searchBtn'>검색</button>\n    </div>\n  `;\n  } \n\n}\n\nexport class Paging extends Component {\n\n\n  template(){\n    const select = Number(this.state.size)\n    return `\n      <div data-component=paging id=\"paging\">\n        <label for=\"pagination\" value=${select}>페이지</label>\n          <select data-action =\"page\">\n          <option value=5 ${select === 5? \"selected\" : \"\"}>5</option>\n          <option value=10 ${select === 10? \"selected\" : \"\"}>10</option>\n          <option value=20 ${select === 20? \"selected\" : \"\"}>20</option>\n        </select>\n      </div>\n    `;\n  }\n\n}\n\nexport class Sorting extends Component{\n\n\n  template(){\n    const selected = this.state.order\n    return `\n    <div data-component='sorting' id=\"sorting\">\n      <label for=\"sorting\">날짜정렬</label>\n      <select data-action=\"order\">\n        <option \n            name='order' value=\"dsc\" \n            ${selected === 'dsc'? \"selected\" : \"\"}>최신</option>\n        <option \n            name='order' value=\"asc\"\n            ${selected === 'asc'? \"selected\" : \"\"}>예전</option>\n      </select>\n    </div>`\n    ;\n  }\n\n}\n\nexport class SortButton extends Component{\n\n  template(){\n    return `\n      <div id=\"sortbutton\">\n        <button data-action = 'all' id=\"refreshall\">초기화</button>\n        <button data-action = 'page' id=\"refreshpage\">새로고침</button>\n      </div>\n    `;\n  }\n\n}\n\n\nexport class Postlist extends Component{\n\n\n  template(){\n    \n    const items = this.state.data\n    const classOn = this.state.name !== '' ?`class='writer-on'` : \"\" \n\n    return `\n    \n      <div id='postlist'>\n        <ul>\n          <li>글번호</li>\n          <li data-action='title'>제목</li>\n          <li>작성자</li>\n          <li>작성일</li>\n        </ul>\n        ${ items.length === 0 ? \"\" : \n          items.map( (item, idx) => `\n          <ul data-index=${item.id}>  \n            <li id= ${item.id}>${item.id}</li>\n            <li data-action='title'>${item.title}</li>\n            <li data-action='writer' ${classOn} >${item.writer}</li>\n            <li>${item.date.split('T')[0]}</li>\n          </ul>`)\n          .join(\"\")\n        }\n      </div>`\n  }\n}\n\nclass PageButton extends Component{\n\n  constructor({ name, state }){\n    super({ name, state });\n    this.child = []; \n    this.child.push( new Pagination({ name :'pagination-button', state }) );\n    this.child.push( new PostButton({ name :'postbutton', state }) );\n  }\n\n}\n\nexport class PostButton extends Component{\n\n  template(){\n    return `\n      <div id=postbutton>\n        <button>글 작성</button>\n      </div>\n    `\n  }\n  \n}\n\n\nexport class Pagination extends Component{\n\n  page; group\n\n  template(){\n    const { page, size, total, data } =  this.state;\n    const less = Number(page) > 1;\n    const more = Number(size)*Number(page) < Number(total) ;\n    // console.log('postListPage============', this.state)\n\n    return `\n      <div id=pagination-button>\n      ${ Number(total) === 0 ? `<span class=\"none-display\">\"게시글이 존재 하지 않습니다.\"</span>` : \"\"}\n      ${ less ? `<button data-action=\"less\">이전</button>` : \"\" }\n      ${ more ? `<button data-action=\"more\">더보기</button>` : \"\" }\n      ${ Number(total) && !more ? `<span class=\"none-display\">\"마지막 페이지 입니다\"</span>` : \"\" }\n      </div>\n    `\n  }\n\n}\n"," const viewRouter = {\n  index : 0 , \n  setIndex(index){\n    this.index = index\n  }\n}\n\nexport default viewRouter","import Component from '../lib/Component.js'\nimport viewRouter from './router';\nexport class PostSinglePage extends Component{\n  \n  child; \n\n  constructor({ name, state }){\n    super({ name, state })\n    // this.root = root;\n    this.child = [];\n    this.child.push( new Header({ name : 'header', state }))\n    this.child.push( new Contents({ name : 'contents', state }))\n    this.child.push( new BottomButton({ name : 'bottombutton', state }))\n\n  }\n\n}\n\n\nexport class Header extends Component{\n  \n\n  template(){\n    // console.log(viewRouter, this.state)\n\n    const index = viewRouter.index \n    const data = this.state.data.filter(ele => ele.id  === Number(index))[0]\n\n    if( !data || data.length === 0 ) return false\n    return `\n      <header id=\"header\">\n        <div class='single-header'>\n          <span>글번호</span>\n          <span>제목</span>\n          <span>작성자</span>\n          <span>날짜</span>\n        </div>\n        <div class='single-content'>\n          <span>${ data.id }</span>\n          <span>${ data.title }</span>\n          <span>${ data.writer }</span>\n          <span>${ data.date.split('T')[0] }</span>\n        </div>\n\n      </header>\n    `\n  }\n\n}\n\nexport class Contents extends Component{\n\n\n  template(){\n    const index = viewRouter.index \n    const data = this.state.data.filter(ele => ele.id  === Number(index))[0]\n\n    return `\n      <div id=\"contents\">\n        <textarea cols=\"50\" rows=\"20\" name ='content' readonly>${data.content}</textarea>\n      </div>\n    `;  \n  }\n  \n}\n\nexport class BottomButton extends Component{\n  \n\n\n  template(){\n    return `\n      <div id=\"bottombutton\">\n      <button data-action=\"list\">목록</button>\n        <button data-action=\"edit\">수정</button>\n        <button data-action=\"delete\">삭제</button>\n      </div>\n    `;\n  }\n\n}\n","import  Component  from \"../lib/Component.js\";\nimport { PostListPage } from \"./PostListPage.js\";\nimport { PostSinglePage } from \"./PostSingle.js\";\n\nclass App extends Component{\n\n  constructor({ name, state }){\n    super({ name, state })\n    this.components.push(new PostListPage({ name : 'postlistpage' , state}));\n    this.components.push(new PostSinglePage({ name :'postsingle', state }));\n  }\n\n}\n\nexport default new App({ name : 'app'})","import Store from './src/lib/Store.js';\nimport app from './src/views/App.js'\nimport Router from './src/lib/Router.js';\nimport viewRouter from './src/views/router.js';\n\nexport function ssr_converter (context) {\n  return new Promise(async (resolve, reject) => {\n\n    let { url, state, index } = context;\n    \n    const store = new Store();\n    const router = new Router();\n\n    router.subscribe(app);\n    router.setRoutes( \n      [\n        { path : '/',\n          comPosition : 0 \n        },\n        { path : '/post-single',\n          comPosition : 1\n        },\n        { path : '/post-edit',\n          comPosition : 2\n        },\n        { \n          path : '/nout-found',\n          comPosition : 3\n        }\n      ] \n    )\n    url = state.data.length === 0 ? '/not-found' : url \n    router.setPathCur(url, true);\n    viewRouter.setIndex(Number(index))\n    store.initState(state, true);\n    app.setState(state);\n\n    let ssr_html= router.serverRender();\n   \n    if(ssr_html) resolve( ssr_html ); \n    else{ \n      router.setPathCur('/not-found', true);\n      ssr_html = router.serverRender();\n\n      if(ssr_html) resolve(ssr_html);\n      else reject( new Error('SSR error') );\n    }\n  })\n\n}\n","class Router {\n  \n  routes; base; index; root; app; cur; eventBounder;\n  \n  constructor(){\n\n    this.cur = 0;\n    this.routeState = { value : \"\" };\n\n  }\n  \n  subscribe(app){\n    this.app = app;\n  }\n\n  setRoutes( routes ){\n    this.routes = routes\n  }\n\n  setRoot(root){\n    if(!this.root && !root) this.root = document.querySelector('#root')\n    if(!this.root) this.root = root \n    // console.log(this.root)\n    try{\n      this.app.setRoot(this.root);\n      this.app.onLoad();\n      // this.app.setEvent();\n\n    }catch(err){\n      if(err instanceof TypeError){ \n        return this.serverRender()\n      }\n    }\n  }\n\n\n  setIndex(index){\n    this.index =Number(index)\n  }\n  \n  setPathCur(newCur, serverRender=false){\n    // console.log('newCur========', newCur)\n    newCur = newCur === '/page' ? '/' : newCur\n    this.cur = this.routes.filter( \n      route => route.path === newCur )[0].comPosition;\n    \n    this.app.curPos = this.cur; \n\n    if(serverRender) return \n    this.templateRender()\n\n  }\n\n  templateRender(){\n    this.root.innerHTML = this.app.template();\n    this.setRoot(this.root)\n  }\n  \n  serverRender(){\n    // console.log('asdfasdfasdfdsa=========', this.app.state)\n    return this.app.template();\n  }\n}\n\nexport default Router;","const ref = [0, 31, 59, 90, 120, 151, 182]\nconst  setData = (dataLength = 30) => {\n  return new Array(dataLength).fill(0).map((ele, idx) => {\n    let day = idx + 1 \n    const mon = day <= 31 ? 1 : day <= 59 ? 2 : day <= 90 \n      ? 3 : day <= 120 ? 4 : day <= 151 ? 5 : day <= 182 ? 6 : 7\n    return {\n      id : idx+1, \n      title : `title${idx+1}`,\n      writer : `name${idx+1}`,\n      content : `content${idx+1}`,\n      date : `2021-${mon}-${day-ref[mon-1]}`\n    }\n  })\n}\nlet totData = setData(200)\n\nmodule.exports = totData\n\n  \n\n","let tem = require('./Data.js')\nlet totData = tem; \n\nlet initialState = {\n  data : totData.slice().reverse().slice(0,5),\n  page : 1,\n  size : 5, \n  order : 'dsc',\n  filter : '',\n  name : '',\n  total : totData.length,\n  index : 0\n}\n\n// ---- Query executor ---- \nconst queryExecutor = {\n\n  // SELECT * FROM _ WHERE all culumn LIKE '%keyword%' \n  filterByKeyWord : (keyword, data=totData) => {\n    // filter by search keyworkd\n    // console.log(\"datata\", data)\n    return keyword === \"\" \n    ? data \n    : data.filter( ele =>{\n        let bool = false \n        for(let [ key,val ] of Object.entries(ele)){\n          if(key === 'id' || key ==='date' || key === 'index') continue\n          // console.log( val, keyword)\n          if(!String(val).includes(keyword)) continue \n          bool = true \n          // console.log(ele) \n          break\n        }\n        return bool\n    })\n  },\n\n  // SELECT * FROM _ WHERE writer = name\n  filterByName : (name, data) => {\n    // filter by writer name\n    // console.log(\"datata\", data)\n\n    return  name === \"\" \n    ? data \n    : data.filter( ele =>{\n        let bool = false \n        for(let [ key,val ] of Object.entries(ele)){\n          if(key === 'writer' && String(val) === name ){\n            bool = true\n            break\n          }\n        }\n        return bool\n    })\n  },\n\n  // LIMIT & OFFSET \n  setRange : (page, size, offset, end) => {\n    // set view data range  \n    let _from = (page - 1) * size - offset; \n    _from = _from < 0 ? 0 : _from; \n\n    let _to = _from + size + offset;\n    _to = _to >= end ? end : _to; \n    // console.log(page, size, _from, _to)\n    return [_from, _to, end] \n  },\n  \n  // ORDER BY & INDEX\n  setIndexData : (order, _data) => {\n    _data = order === 'dsc' ? _data.reverse() : _data\n    \n    return _data.slice()\n      .map((item, idx) => {\n      item['index'] = idx\n      return item\n    })\n  }\n}\nmodule.exports = {\n  updateStateByQueryExecutor  : (state) =>{\n    let{ filter, name, order, page, size, data, total } = state \n  \n    page = Number(page); size= Number(size);\n    // console.log(\"executor=\", page, size, filter, name, order, data)\n    let filtered = queryExecutor.filterByKeyWord(filter);\n    // console.log(filtered)\n    \n    filtered = queryExecutor.filterByName(name, filtered);\n    // console.log(filtered)\n    \n    let [ from, to ] = queryExecutor.setRange(page, size, 0, filtered.length);\n  \n    let totFilterData = queryExecutor.setIndexData(order, filtered.slice());\n    data = totFilterData.slice(from, to);\n    total = totFilterData.length; \n  \n    state = { ...state, data, total }\n    // console.log(state)\n    return state \n  },\n  getPathURL : (state) => {\n    const { filter, name, order, data, total, page, size } = state\n    const id = `filter=${filter}&name=${name}&order=${order}&page=${page}&size=${size}`\n    \n    return id\n  },\n\n  updatePost : ( { writer, title , content, id } )=>{\n    // console.log(\"id===========\", id)\n    totData = totData.map( ele => {\n\n      if( Number(ele.id) === Number(id) ) {\n        ele.writer = writer; \n        ele.title = title\n        ele.content = content;\n      }\n      return ele\n    })\n    // console.log(totData[ totData.length-1 ])\n    return totData \n  },\n\n  createPost : ( { writer, title, content } ) =>{\n    const id = totData[totData.length -1].id + 1;\n    totData.push({\n      id, writer, title, content, date: new Date().toISOString()\n    })\n    return totData\n  },\n\n  deletePost : ( id ) => {\n    for(let i = 0 ; i < totData.length ; i++){\n      if( totData[i].id === Number(id) ) totData.splice(i,1);\n    }\n    return totData;\n  }\n  ,\n  getInitialState : () => {\n    initialState.data = totData.slice().reverse().slice(0,5)\n    return initialState\n  }\n\n}\n","const { SSR } = require('../public/ssr.js')\n\nconst getStringHtml = async (context) => {\n  const { state } = context\n  // console.log(context)\n  // console.log(SSR.ssr_converter(context))\n  const ssrRendered = await SSR.ssr_converter(context).then(result)\n  const result = template(state, ssrRendered);\n  // console.log(result)\n  // console.log(typeof result)\n  \n  return !result \n    ? 'nothing to rend'\n    : result\n}\n\n\nconst template = (state, ssr_html) => {\n  return `\n  <!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Document</title>\n  <script>window.state=${JSON.stringify(state)}</script>\n</head>\n<body>\n  <div id='root'>\n    ${ssr_html} \n  </div>\n  <script src=\"./csr.js\"></script>\n</body>\n</html>\n  `\n}\n\nmodule.exports = getStringHtml\n","\nclass ServerStore{\n  state; \n  constructor(state){\n    this.state = state ;\n  }\n  setState(newState){\n    this.state = { ...this.state, ...newState }\n  }\n}\n\n\n\nmodule.exports = { store  : new ServerStore()} ;\n","/*global window, global*/\nvar util = require(\"util\")\nvar assert = require(\"assert\")\nfunction now() { return new Date().getTime() }\n\nvar slice = Array.prototype.slice\nvar console\nvar times = {}\n\nif (typeof global !== \"undefined\" && global.console) {\n    console = global.console\n} else if (typeof window !== \"undefined\" && window.console) {\n    console = window.console\n} else {\n    console = {}\n}\n\nvar functions = [\n    [log, \"log\"],\n    [info, \"info\"],\n    [warn, \"warn\"],\n    [error, \"error\"],\n    [time, \"time\"],\n    [timeEnd, \"timeEnd\"],\n    [trace, \"trace\"],\n    [dir, \"dir\"],\n    [consoleAssert, \"assert\"]\n]\n\nfor (var i = 0; i < functions.length; i++) {\n    var tuple = functions[i]\n    var f = tuple[0]\n    var name = tuple[1]\n\n    if (!console[name]) {\n        console[name] = f\n    }\n}\n\nmodule.exports = console\n\nfunction log() {}\n\nfunction info() {\n    console.log.apply(console, arguments)\n}\n\nfunction warn() {\n    console.log.apply(console, arguments)\n}\n\nfunction error() {\n    console.warn.apply(console, arguments)\n}\n\nfunction time(label) {\n    times[label] = now()\n}\n\nfunction timeEnd(label) {\n    var time = times[label]\n    if (!time) {\n        throw new Error(\"No such label: \" + label)\n    }\n\n    delete times[label]\n    var duration = now() - time\n    console.log(label + \": \" + duration + \"ms\")\n}\n\nfunction trace() {\n    var err = new Error()\n    err.name = \"Trace\"\n    err.message = util.format.apply(null, arguments)\n    console.error(err.stack)\n}\n\nfunction dir(object) {\n    console.log(util.inspect(object) + \"\\n\")\n}\n\nfunction consoleAssert(expression) {\n    if (!expression) {\n        var arr = slice.call(arguments, 1)\n        assert.ok(false, util.format.apply(null, arr))\n    }\n}\n","module.exports = require(\"assert\");","module.exports = require(\"core-js/modules/es.array.concat.js\");","module.exports = require(\"core-js/modules/es.array.fill.js\");","module.exports = require(\"core-js/modules/es.array.filter.js\");","module.exports = require(\"core-js/modules/es.array.for-each.js\");","module.exports = require(\"core-js/modules/es.array.from.js\");","module.exports = require(\"core-js/modules/es.array.includes.js\");","module.exports = require(\"core-js/modules/es.array.is-array.js\");","module.exports = require(\"core-js/modules/es.array.iterator.js\");","module.exports = require(\"core-js/modules/es.array.join.js\");","module.exports = require(\"core-js/modules/es.array.map.js\");","module.exports = require(\"core-js/modules/es.array.reverse.js\");","module.exports = require(\"core-js/modules/es.array.slice.js\");","module.exports = require(\"core-js/modules/es.array.splice.js\");","module.exports = require(\"core-js/modules/es.date.to-iso-string.js\");","module.exports = require(\"core-js/modules/es.date.to-string.js\");","module.exports = require(\"core-js/modules/es.function.bind.js\");","module.exports = require(\"core-js/modules/es.function.name.js\");","module.exports = require(\"core-js/modules/es.json.to-string-tag.js\");","module.exports = require(\"core-js/modules/es.math.to-string-tag.js\");","module.exports = require(\"core-js/modules/es.number.constructor.js\");","module.exports = require(\"core-js/modules/es.object.create.js\");","module.exports = require(\"core-js/modules/es.object.define-properties.js\");","module.exports = require(\"core-js/modules/es.object.define-property.js\");","module.exports = require(\"core-js/modules/es.object.entries.js\");","module.exports = require(\"core-js/modules/es.object.get-own-property-descriptor.js\");","module.exports = require(\"core-js/modules/es.object.get-own-property-descriptors.js\");","module.exports = require(\"core-js/modules/es.object.get-prototype-of.js\");","module.exports = require(\"core-js/modules/es.object.keys.js\");","module.exports = require(\"core-js/modules/es.object.set-prototype-of.js\");","module.exports = require(\"core-js/modules/es.object.to-string.js\");","module.exports = require(\"core-js/modules/es.promise.js\");","module.exports = require(\"core-js/modules/es.reflect.construct.js\");","module.exports = require(\"core-js/modules/es.regexp.exec.js\");","module.exports = require(\"core-js/modules/es.string.includes.js\");","module.exports = require(\"core-js/modules/es.string.iterator.js\");","module.exports = require(\"core-js/modules/es.string.split.js\");","module.exports = require(\"core-js/modules/es.symbol.description.js\");","module.exports = require(\"core-js/modules/es.symbol.iterator.js\");","module.exports = require(\"core-js/modules/es.symbol.js\");","module.exports = require(\"core-js/modules/es.symbol.to-string-tag.js\");","module.exports = require(\"core-js/modules/web.dom-collections.for-each.js\");","module.exports = require(\"core-js/modules/web.dom-collections.iterator.js\");","module.exports = require(\"cors\");","module.exports = require(\"express\");","module.exports = require(\"global-jsdom/register\");","module.exports = require(\"regenerator-runtime/runtime.js\");","module.exports = require(\"util\");","module.exports = require(\"fs\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","require('global-jsdom/register')\nconst express = require('express');\nconst cors = require('cors')\nconst fs =require('fs');\nconst path = require('path')\nconst server = express(); \nconst PORT = 3001;\n\nconst getStringHtml = require('./src/ssr.service.js');\nconst { store } = require('./src/store.js');\nconst { \n  updateStateByQueryExecutor, \n  getPathURL, getInitialState, \n  updatePost, createPost, deletePost, \n} = require('./src/executor.js')\n\nserver.options('*', cors());\nserver.use(express.json())\nserver.use(express.urlencoded({ extended : true }))\nserver.use(express.static(path.resolve(__dirname, 'public')));\n\nconst updateCache = (req, res) => {\n  if(!req.query) return res.status(400).end();\n\n  store.setState(updateStateByQueryExecutor(req.query));\n  const { data, total } = store.state\n\n  res.json({ id : getPathURL(store.state), data, total })\n};\n\nconst updateState = async (req, res)=> {\n  if( !req.body ) return res.status(400).end(); \n  store.setState(req.body)\n  return res.status(203).end();\n}\n\nserver.get('/', async (req, res) => {\n  store.setState(getInitialState()) \n  // console.log('초반', store.state)\n  const redirectTo = `/page?` + getPathURL(store.state);\n \n  return res.redirect(redirectTo)  ;\n})\n\nserver.get('/page', async (req, res) => {\n\n  if( !store.state ) store.setState(getInitialState())\n  // console.log('페이지', store.state)\n  const filePath = 'page?' + getPathURL(req.query)\n  const fileURL = path.resolve(__dirname,'../../client/resources' , 'index_'+ filePath +'.html');\n  let html ;\n    if(!fs.existsSync(fileURL)){\n      html = await getStringHtml({ url : '/', state : store.state, index : 0 })\n      await fs.writeFileSync(fileURL, html);\n    }\n    else{\n      html = await fs.readFileSync(fileURL, 'utf-8');\n    }\n\n  return res.send(html)\n})\n\nserver.get('/post-single', async (req, res) => {\n  const { index } = req.query; \n  const result = await getStringHtml({ url : '/post-single', state : store.state, index } )\n\n  return res.send(result)\n})\n\nserver.get('/api/cache', updateCache);\nserver.put('/api/state', updateState);\n\n\nserver.post('/post/edit', (req, res) => {\n  if(req.body.id === ''){ \n    if(!createPost(req.body) ) \n      return res.status(500).send('Internal server error');\n\n    store.setState( updateStateByQueryExecutor(\n      { filter : \"\", order : 'dsc', name : \"\",  page : 1, size : 5 }\n      )\n    )\n    return res.json(store.state)\n  }\n\n  if( !updatePost(req.body)) \n    return res.status(500).send('Internal server error');\n\n  const name = store.state.name !== '' ? req.body.writer : '';\n  store.setState({ name })\n  store.setState( updateStateByQueryExecutor(store.state) );\n\n  return res.json(store.state)\n})\n\nserver.delete('/post/delete', (req,res) => {\n\n  // console.log('asdfasdf deltete', store.state)\n  if( !deletePost(req.query.id) ) \n    return res.status(500).send(\"Internal server error\");\n  \n  store.setState( updateStateByQueryExecutor(\n    { filter : \"\", order : 'dsc', name : \"\",  page : 1, size : 5 }\n  ));\n  \n  return res.status(202).json(store.state);\n})\n\n\nserver.listen(PORT, ()=> {\n  console.log(\"server listning by Port= \"+PORT)\n})\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","n","constructor","state","name","this","components","child","curPos","oldPos","firstBonder","eventHandler","bind","secondBonder","secondEventHandler","setState","length","map","node","setRoot","root","el","querySelector","setEvent","template","renderHtml","join","render","innerHTML","requestAnimationFrame","PostListPage","super","push","PostListHeader","Postlist","PageButton","Search","Paging","Sorting","SortButton","filter","select","Number","size","selected","order","items","data","classOn","item","idx","id","title","writer","date","split","Pagination","PostButton","page","total","less","more","u","index","setIndex","PostSinglePage","Header","Contents","BottomButton","ele","content","ssr_converter","context","Promise","async","resolve","reject","url","store","cacheHandler","subscribe","app","initState","initial","server","newState","history","pushState","location","origin","getCacheId","updateView","keys","searchCache","renderAll","hydrate","router","cur","routeState","setRoutes","routes","document","onLoad","err","TypeError","serverRender","setPathCur","newCur","route","path","comPosition","templateRender","x","ssr_html","Error","ref","setData","dataLength","Array","fill","day","mon","totData","module","tem","require","initialState","slice","reverse","queryExecutor","filterByKeyWord","keyword","bool","entries","val","String","includes","filterByName","setRange","offset","end","_from","_to","setIndexData","_data","updateStateByQueryExecutor","filtered","from","to","totFilterData","getPathURL","updatePost","createPost","Date","toISOString","deletePost","i","splice","getInitialState","SSR","getStringHtml","then","result","ssrRendered","JSON","stringify","ServerStore","express","cors","fs","PORT","options","use","json","urlencoded","extended","__dirname","updateCache","req","res","query","status","updateState","body","redirectTo","redirect","filePath","fileURL","existsSync","html","writeFileSync","readFileSync","send","put","post","listen","console","log"],"sourceRoot":""}